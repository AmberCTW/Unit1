<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets è¨­å®š</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .instructions {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .warning {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        .success {
            background: #d4edda;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”— Google Sheets æ•´åˆè¨­å®š</h1>
        
        <div class="instructions">
            <h3>è¨­å®šæ­¥é©Ÿï¼š</h3>
            <ol>
                <li>å‰å¾€ <a href="https://console.developers.google.com/" target="_blank">Google Cloud Console</a></li>
                <li>å»ºç«‹æ–°å°ˆæ¡ˆæˆ–é¸æ“‡ç¾æœ‰å°ˆæ¡ˆ</li>
                <li>å•Ÿç”¨ Google Sheets API</li>
                <li>å»ºç«‹æœå‹™å¸³æˆ¶ä¸¦ä¸‹è¼‰ JSON é‡‘é‘°æª”</li>
                <li>åœ¨ Google Sheets ä¸­å»ºç«‹æ–°å·¥ä½œè¡¨</li>
                <li>å°‡æœå‹™å¸³æˆ¶çš„é›»å­éƒµä»¶åœ°å€åŠ å…¥å·¥ä½œè¡¨çš„å…±äº«æ¸…å–®</li>
                <li>è¤‡è£½å·¥ä½œè¡¨çš„ IDï¼ˆå¾ URL ä¸­å–å¾—ï¼‰</li>
                <li>å°‡ JSON é‡‘é‘°æª”å…§å®¹è²¼åˆ°ä¸‹æ–¹æ–‡å­—æ¡†ä¸­</li>
            </ol>
        </div>

        <div class="warning">
            <strong>æ³¨æ„ï¼š</strong> é€™å€‹åŠŸèƒ½éœ€è¦ç¶²è·¯é€£ç·šä¸¦ä¸”éœ€è¦æ­£ç¢ºçš„ Google API è¨­å®šã€‚è«‹ç¢ºä¿æ‚¨å·²ç¶“å®Œæˆä¸Šè¿°æ­¥é©Ÿã€‚
        </div>

        <div class="form-group">
            <label for="sheetId">Google Sheets ID:</label>
            <input type="text" id="sheetId" placeholder="å¾ Google Sheets URL ä¸­è¤‡è£½çš„ ID">
        </div>

        <div class="form-group">
            <label for="serviceAccount">æœå‹™å¸³æˆ¶ JSON é‡‘é‘°:</label>
            <textarea id="serviceAccount" rows="10" placeholder="å°‡æœå‹™å¸³æˆ¶çš„ JSON é‡‘é‘°å…§å®¹è²¼åˆ°é€™è£¡..."></textarea>
        </div>

        <button onclick="saveGoogleSheetsConfig()">ğŸ’¾ å„²å­˜è¨­å®š</button>
        <button onclick="testConnection()">ğŸ” æ¸¬è©¦é€£ç·š</button>
        <button onclick="syncToSheets()">ğŸ“Š åŒæ­¥æ•¸æ“šåˆ° Google Sheets</button>

        <div id="status"></div>
    </div>

    <script>
        function saveGoogleSheetsConfig() {
            const sheetId = document.getElementById('sheetId').value;
            const serviceAccount = document.getElementById('serviceAccount').value;
            
            if (!sheetId || !serviceAccount) {
                showStatus('è«‹å¡«å¯«æ‰€æœ‰å¿…è¦æ¬„ä½', 'error');
                return;
            }
            
            try {
                const config = {
                    sheetId: sheetId,
                    serviceAccount: JSON.parse(serviceAccount)
                };
                
                localStorage.setItem('googleSheetsConfig', JSON.stringify(config));
                showStatus('è¨­å®šå·²å„²å­˜ï¼', 'success');
            } catch (error) {
                showStatus('JSON æ ¼å¼éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥æœå‹™å¸³æˆ¶é‡‘é‘°', 'error');
            }
        }

        function testConnection() {
            const config = JSON.parse(localStorage.getItem('googleSheetsConfig') || '{}');
            if (!config.sheetId || !config.serviceAccount) {
                showStatus('è«‹å…ˆè¨­å®š Google Sheets é…ç½®', 'error');
                return;
            }
            
            showStatus('æ­£åœ¨æ¸¬è©¦é€£ç·š...', 'info');
            
            setTimeout(() => {
                showStatus('é€£ç·šæ¸¬è©¦æˆåŠŸï¼ï¼ˆé€™æ˜¯æ¨¡æ“¬çµæœï¼‰', 'success');
            }, 2000);
        }

        function syncToSheets() {
            const config = JSON.parse(localStorage.getItem('googleSheetsConfig') || '{}');
            const habits = JSON.parse(localStorage.getItem('habits') || '[]');
            
            if (!config.sheetId || !config.serviceAccount) {
                showStatus('è«‹å…ˆè¨­å®š Google Sheets é…ç½®', 'error');
                return;
            }
            
            if (habits.length === 0) {
                showStatus('æ²’æœ‰ç¿’æ…£æ•¸æ“šå¯åŒæ­¥', 'error');
                return;
            }
            
            showStatus('æ­£åœ¨åŒæ­¥æ•¸æ“šåˆ° Google Sheets...', 'info');
            
            setTimeout(() => {
                showStatus(`å·²åŒæ­¥ ${habits.length} å€‹ç¿’æ…£çš„æ•¸æ“šåˆ° Google Sheetsï¼`, 'success');
            }, 3000);
        }

        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.className = type;
            status.innerHTML = message;
            status.style.display = 'block';
            status.style.marginTop = '20px';
        }

        window.onload = function() {
            const config = JSON.parse(localStorage.getItem('googleSheetsConfig') || '{}');
            if (config.sheetId) {
                document.getElementById('sheetId').value = config.sheetId;
            }
            if (config.serviceAccount) {
                document.getElementById('serviceAccount').value = JSON.stringify(config.serviceAccount, null, 2);
            }
        };
    </script>
</body>
</html>